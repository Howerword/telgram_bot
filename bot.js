require('dotenv').config(); // –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ –∑–º—ñ–Ω–Ω—ñ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
const { Telegraf, Markup } = require('telegraf'); // –Ü–º–ø–æ—Ä—Ç—É—î–º–æ Telegraf

const bot = new Telegraf(process.env.BOT_TOKEN); // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –±–æ—Ç–∞

// –ì–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é –∑ –∫–Ω–æ–ø–∫–∞–º–∏
const mainMenu = Markup.keyboard([
    ['üìÖ –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è'],
    ['üîò –ö–Ω–æ–ø–∫–∞ 1', 'üîò –ö–Ω–æ–ø–∫–∞ 2'],
    ['üîò –ö–Ω–æ–ø–∫–∞ 3', 'üîò –ö–Ω–æ–ø–∫–∞ 4']
]).resize(); // –†–æ–±–∏–º–æ –∫–Ω–æ–ø–∫–∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–∏–º–∏

// –ö–Ω–æ–ø–∫–∏ –≤–∏–±–æ—Ä—É —Ö–≤–∏–ª–∏–Ω –¥–ª—è –Ω–∞–≥–∞–¥—É–≤–∞–Ω—å
const reminderTimes = [30, 35, 40, 45];
const reminderMenu = Markup.inlineKeyboard(
    reminderTimes.map((time) => Markup.button.callback(`${time} —Ö–≤`, `set_reminder_${time}`)),
    { columns: 2 }
);

// –û–±—Ä–æ–±–Ω–∏–∫ –∫–æ–º–∞–Ω–¥–∏ /start
bot.start((ctx) => {
    ctx.reply('–ü—Ä–∏–≤—ñ—Ç! –¶–µ —Ç–µ—Å—Ç–æ–≤—ñ –∫–Ω–æ–ø–∫–∏:', mainMenu);
});

// –û–±—Ä–æ–±–∫–∞ –Ω–∞—Ç–∏—Å–∫–∞–Ω—å –∫–Ω–æ–ø–æ–∫
bot.hears('üîò –ö–Ω–æ–ø–∫–∞ 1', (ctx) => ctx.reply('–¢–∏ –Ω–∞—Ç–∏—Å–Ω—É–≤ –∫–Ω–æ–ø–∫—É 1!'));
bot.hears('üîò –ö–Ω–æ–ø–∫–∞ 2', (ctx) => ctx.reply('–¢–∏ –Ω–∞—Ç–∏—Å–Ω—É–≤ –∫–Ω–æ–ø–∫—É 2!'));
bot.hears('üîò –ö–Ω–æ–ø–∫–∞ 3', (ctx) => ctx.reply('–¢–∏ –Ω–∞—Ç–∏—Å–Ω—É–≤ –∫–Ω–æ–ø–∫—É 3!'));
bot.hears('üîò –ö–Ω–æ–ø–∫–∞ 4', (ctx) => ctx.reply('–¢–∏ –Ω–∞—Ç–∏—Å–Ω—É–≤ –∫–Ω–æ–ø–∫—É 4!'));

// –û–±—Ä–æ–±–∫–∞ –∫–Ω–æ–ø–∫–∏ "üìÖ –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è"
bot.hears('üìÖ –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è', (ctx) => {
    ctx.reply('–û–±–µ—Ä—ñ—Ç—å, –Ω–∞ —Å–∫—ñ–ª—å–∫–∏ —Ö–≤–∏–ª–∏–Ω –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ—ó –≥–æ–¥–∏–Ω–∏ —Ö–æ—á–µ—Ç–µ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è:', reminderMenu);
});

// –û–±—Ä–æ–±–∫–∞ –≤–∏–±–æ—Ä—É —á–∞—Å—É –Ω–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è
bot.action(/^set_reminder_\d+$/, (ctx) => {
    const selectedTime = parseInt(ctx.match[0].split('_')[2]);
    ctx.reply(`‚úÖ –ù–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ ${selectedTime} —Ö–≤–∏–ª–∏–Ω –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ—ó –≥–æ–¥–∏–Ω–∏.`);
});

// –ó–∞–ø—É—Å–∫–∞—î–º–æ –±–æ—Ç–∞
bot.launch();
console.log('–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω–æ!');
